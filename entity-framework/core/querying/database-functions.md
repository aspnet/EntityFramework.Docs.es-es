---
title: 'Funciones de base de datos: EF Core'
description: Información sobre las funciones de base de datos compatibles con la traducción de consultas de EF Core
author: smitpatel
ms.date: 11/10/2020
uid: core/querying/database-functions
ms.openlocfilehash: 34ced2a602168f6ed84763c046ef581cb87026e8
ms.sourcegitcommit: 42bbf7f68e92c364c5fff63092d3eb02229f568d
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 11/11/2020
ms.locfileid: "94503787"
---
# <a name="database-functions"></a><span data-ttu-id="3d349-103">Funciones de base de datos</span><span class="sxs-lookup"><span data-stu-id="3d349-103">Database Functions</span></span>

<span data-ttu-id="3d349-104">Las funciones de base de datos son el equivalente a los [métodos de C#](/dotnet/csharp/programming-guide/classes-and-structs/methods) en las bases de datos.</span><span class="sxs-lookup"><span data-stu-id="3d349-104">Database functions are the database equivalent of [C# methods](/dotnet/csharp/programming-guide/classes-and-structs/methods).</span></span> <span data-ttu-id="3d349-105">Se puede invocar una función de base de datos sin ningún parámetro o con varios, y esta calcula el resultado en función de los valores de los parámetros.</span><span class="sxs-lookup"><span data-stu-id="3d349-105">A database function can be invoked with zero or more parameters and it computes the result based on the parameter values.</span></span> <span data-ttu-id="3d349-106">La mayoría de las bases de datos, que utilizan SQL para realizar consultas, admiten las funciones de base de datos.</span><span class="sxs-lookup"><span data-stu-id="3d349-106">Most databases, which use SQL for querying have support for database functions.</span></span> <span data-ttu-id="3d349-107">Por lo tanto, la salida SQL generada por la traducción de consultas de EF Core también permite invocar funciones de base de datos.</span><span class="sxs-lookup"><span data-stu-id="3d349-107">So SQL generated by EF Core query translation also allows invoking database functions.</span></span> <span data-ttu-id="3d349-108">Los métodos de C# no tienen por qué traducirse estrictamente en funciones de base de datos en EF Core.</span><span class="sxs-lookup"><span data-stu-id="3d349-108">C# methods don't have to translate strictly to database functions in EF Core.</span></span>

- <span data-ttu-id="3d349-109">Un método de C# puede no tener una función de base de datos equivalente.</span><span class="sxs-lookup"><span data-stu-id="3d349-109">A C# method may not have an equivalent database function.</span></span>
  - <span data-ttu-id="3d349-110">El método <xref:System.String.IsNullOrEmpty%2A?displayProperty=nameWithType> se traduce en una comprobación de valores NULL y en una comparación con una cadena vacía en la base de datos, y no en una función.</span><span class="sxs-lookup"><span data-stu-id="3d349-110"><xref:System.String.IsNullOrEmpty%2A?displayProperty=nameWithType> method translates to a null check and a comparison with an empty string in the database rather than a function.</span></span>
  - <span data-ttu-id="3d349-111">El método <xref:System.String.Equals(System.String,System.StringComparison)?displayProperty=nameWithType> no tiene una base de datos equivalente, ya que la comparación de cadenas no puede representarse ni imitarse fácilmente en una base de datos.</span><span class="sxs-lookup"><span data-stu-id="3d349-111"><xref:System.String.Equals(System.String,System.StringComparison)?displayProperty=nameWithType> method doesn't have database equivalent since string comparison can't be represented or mimicked easily in a database.</span></span>
- <span data-ttu-id="3d349-112">Una función de base de datos puede no tener un método de C# equivalente.</span><span class="sxs-lookup"><span data-stu-id="3d349-112">A database function may not have an equivalent C# method.</span></span> <span data-ttu-id="3d349-113">El operador `??` en C#, que no tiene ningún método, se traduce en la función `COALESCE` en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="3d349-113">The `??` operator in C#, which doesn't have any method, translates to the `COALESCE` function in the database.</span></span>

## <a name="types-of-database-functions"></a><span data-ttu-id="3d349-114">Tipos de funciones de base de datos</span><span class="sxs-lookup"><span data-stu-id="3d349-114">Types of database functions</span></span>

<span data-ttu-id="3d349-115">La generación de la salida SQL de EF Core admite un subconjunto de funciones que se pueden usar en las bases de datos.</span><span class="sxs-lookup"><span data-stu-id="3d349-115">EF Core SQL generation supports a subset of functions that can be used in databases.</span></span> <span data-ttu-id="3d349-116">Esta limitación proviene de la capacidad de representar una consulta en LINQ para la función de base de datos determinada.</span><span class="sxs-lookup"><span data-stu-id="3d349-116">This limitation comes from the ability to represent a query in LINQ for the given database function.</span></span> <span data-ttu-id="3d349-117">Además, cada base de datos tiene una compatibilidad variable con las funciones de base de datos, por lo que EF Core proporciona un subconjunto común.</span><span class="sxs-lookup"><span data-stu-id="3d349-117">Further, each database has varying support of database functions, so EF Core provides a common subset.</span></span> <span data-ttu-id="3d349-118">Un proveedor de bases de datos es libre de ampliar la generación de salidas SQL de EF Core para admitir más patrones.</span><span class="sxs-lookup"><span data-stu-id="3d349-118">A database provider is free to extend EF Core SQL generation to support more patterns.</span></span> <span data-ttu-id="3d349-119">A continuación, se indican los tipos de funciones de base de datos que EF Core admite e identifica de forma exclusiva.</span><span class="sxs-lookup"><span data-stu-id="3d349-119">Following are the types of database functions EF Core supports and uniquely identifies.</span></span> <span data-ttu-id="3d349-120">Estos términos también ayudan a comprender qué traducciones se integran con los proveedores de EF Core.</span><span class="sxs-lookup"><span data-stu-id="3d349-120">These terms also help in understanding what translations come built in with EF Core providers.</span></span>

### <a name="built-in-vs-user-defined-functions"></a><span data-ttu-id="3d349-121">Funciones integradas frente a las definidas por el usuario</span><span class="sxs-lookup"><span data-stu-id="3d349-121">Built-in vs user-defined functions</span></span>

<span data-ttu-id="3d349-122">Las funciones integradas incluyen las bases de datos predefinidas, pero las definidas por el usuario las define explícitamente el usuario en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="3d349-122">Built-in functions come with database predefined, but user-defined functions are explicitly defined by the user in the database.</span></span> <span data-ttu-id="3d349-123">Cuando EF Core traduce las consultas para usar funciones de base de datos, usa funciones integradas para asegurarse de que la función siempre está disponible en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="3d349-123">When EF Core translates queries to use database functions, it uses built-in functions to make sure that the function is always available on the database.</span></span> <span data-ttu-id="3d349-124">Es necesario distinguir las funciones integradas en algunas bases de datos para generar las salidas SQL correctamente.</span><span class="sxs-lookup"><span data-stu-id="3d349-124">The distinction of built-in functions is necessary in some databases to generate SQL correctly.</span></span> <span data-ttu-id="3d349-125">Por ejemplo, SqlServer requiere que se invoquen todas las funciones definidas por el usuario con un nombre calificado con el esquema.</span><span class="sxs-lookup"><span data-stu-id="3d349-125">For example SqlServer requires that every user-defined function is invoked with a schema-qualified name.</span></span> <span data-ttu-id="3d349-126">Sin embargo, las funciones integradas en SqlServer no tienen un esquema.</span><span class="sxs-lookup"><span data-stu-id="3d349-126">But built-in functions in SqlServer don't have a schema.</span></span> <span data-ttu-id="3d349-127">PostgreSQL define la función integrada en el esquema `public`, pero se puede invocar con nombres calificados con el esquema.</span><span class="sxs-lookup"><span data-stu-id="3d349-127">PostgreSQL defines built-in function in the `public` schema but they can be invoked with schema-qualified names.</span></span>

### <a name="aggregate-vs-scalar-vs-table-valued-functions"></a><span data-ttu-id="3d349-128">Comparación entre las funciones de agregado, escalares y con valores de tabla</span><span class="sxs-lookup"><span data-stu-id="3d349-128">Aggregate vs scalar vs table-valued functions</span></span>

- <span data-ttu-id="3d349-129">Las funciones escalares adoptan valores escalares (como enteros o cadenas) como parámetros y devuelven un valor escalar como resultado.</span><span class="sxs-lookup"><span data-stu-id="3d349-129">Scalar functions take scalar values - like integers or strings - as parameters and return a scalar value as the result.</span></span> <span data-ttu-id="3d349-130">Las funciones escalares se pueden usar en cualquier parte de SQL donde se pueda pasar un valor escalar.</span><span class="sxs-lookup"><span data-stu-id="3d349-130">Scalar functions can be used anywhere in SQL where a scalar value can be passed.</span></span>
- <span data-ttu-id="3d349-131">Las funciones de agregado adoptan un flujo de valores escalares como parámetros y devuelven un valor escalar como resultado.</span><span class="sxs-lookup"><span data-stu-id="3d349-131">Aggregate functions take a stream of scalar values as parameters and return a scalar value as the result.</span></span> <span data-ttu-id="3d349-132">Las funciones de agregado se aplican en todo el conjunto de resultados de consulta o en un grupo de valores generados al aplicar el operador `GROUP BY`.</span><span class="sxs-lookup"><span data-stu-id="3d349-132">Aggregate functions are applied on the whole query result set or on a group of values generated by applying `GROUP BY` operator.</span></span>
- <span data-ttu-id="3d349-133">Las funciones con valores de tabla adoptan valores escalares como parámetros y devuelven un flujo de filas como resultado.</span><span class="sxs-lookup"><span data-stu-id="3d349-133">Table-valued functions take scalar values as parameter(s) and return a stream of rows as the result.</span></span> <span data-ttu-id="3d349-134">Las funciones con valores de tabla se utilizan como un origen de tabla en la cláusula `FROM`.</span><span class="sxs-lookup"><span data-stu-id="3d349-134">Table-valued functions are used as a table source in `FROM` clause.</span></span>

### <a name="niladic-functions"></a><span data-ttu-id="3d349-135">Funciones niládicas</span><span class="sxs-lookup"><span data-stu-id="3d349-135">Niladic functions</span></span>

<span data-ttu-id="3d349-136">Las funciones niládicas son funciones de base de datos especiales que no tienen ningún parámetro y deben invocarse sin paréntesis.</span><span class="sxs-lookup"><span data-stu-id="3d349-136">Niladic functions are special database functions that don't have any parameters and must be invoked without parenthesis.</span></span> <span data-ttu-id="3d349-137">Son similares al acceso a propiedades o campos en una instancia de C#.</span><span class="sxs-lookup"><span data-stu-id="3d349-137">They're similar to property/field access on an instance in C#.</span></span> <span data-ttu-id="3d349-138">Las funciones niládicas se diferencian de las funciones sin parámetros, ya que las últimas requieren paréntesis vacíos.</span><span class="sxs-lookup"><span data-stu-id="3d349-138">Niladic functions differ from parameter-less functions as the latter require empty parenthesis.</span></span> <span data-ttu-id="3d349-139">No hay ningún nombre especial para las funciones de base de datos que siempre requieran paréntesis.</span><span class="sxs-lookup"><span data-stu-id="3d349-139">There's no special name for database functions that requires parenthesis always.</span></span> <span data-ttu-id="3d349-140">Otro subconjunto de funciones de base de datos basado en el número de parámetros son las funciones variádicas.</span><span class="sxs-lookup"><span data-stu-id="3d349-140">Another subset of database functions based on parameter count is variadic functions.</span></span> <span data-ttu-id="3d349-141">Las funciones variádicas pueden adoptar un número variable de parámetros cuando se invocan.</span><span class="sxs-lookup"><span data-stu-id="3d349-141">Variadic functions can take varying number of parameters when invoked.</span></span>

## <a name="database-function-mappings-in-ef-core"></a><span data-ttu-id="3d349-142">Asignaciones de funciones de base de datos en EF Core</span><span class="sxs-lookup"><span data-stu-id="3d349-142">Database function mappings in EF Core</span></span>

<span data-ttu-id="3d349-143">EF Core admite tres formas diferentes de asignación entre las funciones de C# y las funciones de base de datos.</span><span class="sxs-lookup"><span data-stu-id="3d349-143">EF Core supports three different ways of mapping between C# functions and database functions.</span></span>

### <a name="built-in-function-mapping"></a><span data-ttu-id="3d349-144">Asignación de funciones integradas</span><span class="sxs-lookup"><span data-stu-id="3d349-144">Built-in function mapping</span></span>

<span data-ttu-id="3d349-145">De forma predeterminada, los proveedores de EF Core proporcionan asignaciones para varias funciones integradas mediante tipos primitivos.</span><span class="sxs-lookup"><span data-stu-id="3d349-145">By default EF Core providers provide mappings for various built-in functions over primitive types.</span></span> <span data-ttu-id="3d349-146">Por ejemplo, <xref:System.String.ToLower?displayProperty=nameWithType> se traduce en `LOWER` en SqlServer.</span><span class="sxs-lookup"><span data-stu-id="3d349-146">For example, <xref:System.String.ToLower?displayProperty=nameWithType> translates to `LOWER` in SqlServer.</span></span> <span data-ttu-id="3d349-147">Esta funcionalidad permite a los usuarios escribir consultas en LINQ sin problemas.</span><span class="sxs-lookup"><span data-stu-id="3d349-147">This functionality allows users to write queries in LINQ seamlessly.</span></span> <span data-ttu-id="3d349-148">Normalmente, se ofrece una traducción en la base de datos que genera el mismo resultado que la función de C# proporciona en el lado cliente.</span><span class="sxs-lookup"><span data-stu-id="3d349-148">We usually provide a translation in the database that gives the same result as what the C# function provides on the client side.</span></span> <span data-ttu-id="3d349-149">A veces, para lograrlo, la traducción real puede ser algo más complicada que una función de base de datos.</span><span class="sxs-lookup"><span data-stu-id="3d349-149">Sometimes, to achieve that, the actual translation could be something more complicated than a database function.</span></span> <span data-ttu-id="3d349-150">En algunos escenarios, también proporcionamos la traducción más adecuada en lugar de la semántica de C# coincidente.</span><span class="sxs-lookup"><span data-stu-id="3d349-150">In some scenarios, we also provide the most appropriate translation rather than matching C# semantics.</span></span> <span data-ttu-id="3d349-151">La misma característica también se usa para proporcionar traducciones comunes para algunos de los accesos de los miembros de C#.</span><span class="sxs-lookup"><span data-stu-id="3d349-151">The same feature is also used to provide common translations for some of the C# member accesses.</span></span> <span data-ttu-id="3d349-152">Por ejemplo, <xref:System.String.Length?displayProperty=nameWithType> se traduce en `LEN` en SqlServer.</span><span class="sxs-lookup"><span data-stu-id="3d349-152">For example, <xref:System.String.Length?displayProperty=nameWithType> translates to `LEN` in SqlServer.</span></span> <span data-ttu-id="3d349-153">Además de los proveedores, los escritores de complementos también pueden agregar traducciones adicionales.</span><span class="sxs-lookup"><span data-stu-id="3d349-153">Apart from providers, plugin writers can also add additional translations.</span></span> <span data-ttu-id="3d349-154">Esta extensibilidad es útil cuando los complementos agregan compatibilidad con más tipos, como los primitivos, y desean traducir métodos a partir de ellos.</span><span class="sxs-lookup"><span data-stu-id="3d349-154">This extensibility is useful when plugins add support for more types as primitive types and want to translate methods over them.</span></span>

### <a name="effunctions-mapping"></a><span data-ttu-id="3d349-155">Asignación de EF.Functions</span><span class="sxs-lookup"><span data-stu-id="3d349-155">EF.Functions mapping</span></span>

<span data-ttu-id="3d349-156">Puesto que no todas las funciones de base de datos tienen funciones de C# equivalentes, los proveedores de EF Core tienen métodos de C# especiales para invocar determinadas funciones de base de datos.</span><span class="sxs-lookup"><span data-stu-id="3d349-156">Since not all database functions have equivalent C# functions, EF Core providers have special C# methods to invoke certain database functions.</span></span> <span data-ttu-id="3d349-157">Estos métodos se definen como métodos de extensión mediante `EF.Functions` que se usarán en consultas LINQ.</span><span class="sxs-lookup"><span data-stu-id="3d349-157">These methods are defined as extension methods over `EF.Functions` to be used in LINQ queries.</span></span> <span data-ttu-id="3d349-158">Estos métodos son específicos del proveedor, ya que están estrechamente relacionados con funciones de base de datos concretas.</span><span class="sxs-lookup"><span data-stu-id="3d349-158">These methods are provider-specific as they're closely tied with particular database functions.</span></span> <span data-ttu-id="3d349-159">Por lo tanto, es probable que un método que funciona para un proveedor no funcione para ningún otro proveedor.</span><span class="sxs-lookup"><span data-stu-id="3d349-159">So a method that works for one provider will likely not work for any other provider.</span></span> <span data-ttu-id="3d349-160">Además, puesto que la intención de estos métodos es invocar una función de base de datos en la consulta traducida, intentar evaluarlos en el cliente produce una excepción.</span><span class="sxs-lookup"><span data-stu-id="3d349-160">Further, since the intention of these methods is to invoke a database function in the translated query, trying to evaluate them on the client results in an exception.</span></span>

### <a name="user-defined-function-mapping"></a><span data-ttu-id="3d349-161">Asignación de funciones definidas por el usuario</span><span class="sxs-lookup"><span data-stu-id="3d349-161">User-defined function mapping</span></span>

<span data-ttu-id="3d349-162">Además de las asignaciones proporcionadas por los proveedores de EF Core, los usuarios también pueden definir asignaciones personalizadas.</span><span class="sxs-lookup"><span data-stu-id="3d349-162">Apart from mappings provided by EF Core providers, users can also define custom mapping.</span></span> <span data-ttu-id="3d349-163">Una asignación definida por el usuario amplía la traducción de la consulta según las necesidades del usuario.</span><span class="sxs-lookup"><span data-stu-id="3d349-163">A user-defined mapping extends the query translation according to the user needs.</span></span> <span data-ttu-id="3d349-164">Esta funcionalidad es útil cuando hay funciones definidas por el usuario en la base de datos, que el usuario desea invocar con su consulta LINQ.</span><span class="sxs-lookup"><span data-stu-id="3d349-164">This functionality is useful when there are user-defined functions in the database, which the user wants to invoke from their LINQ query.</span></span>

## <a name="see-also"></a><span data-ttu-id="3d349-165">Consulte también</span><span class="sxs-lookup"><span data-stu-id="3d349-165">See also</span></span>

- [<span data-ttu-id="3d349-166">Asignaciones de funciones integradas de SqlServer</span><span class="sxs-lookup"><span data-stu-id="3d349-166">SqlServer built-in function mappings</span></span>](xref:core/providers/sql-server/functions)
- [<span data-ttu-id="3d349-167">Asignaciones de funciones integradas de Sqlite</span><span class="sxs-lookup"><span data-stu-id="3d349-167">Sqlite built-in function mappings</span></span>](xref:core/providers/sqlite/functions)
- [<span data-ttu-id="3d349-168">Asignaciones de funciones integradas de Cosmos</span><span class="sxs-lookup"><span data-stu-id="3d349-168">Cosmos built-in function mappings</span></span>](xref:core/providers/cosmos/functions)
