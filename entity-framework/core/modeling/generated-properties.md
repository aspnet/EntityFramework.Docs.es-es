---
title: 'Valores generados: EF Core'
description: Cómo configurar la generación de valores para las propiedades al usar Entity Framework Core
author: AndriySvyryd
ms.date: 11/06/2019
uid: core/modeling/generated-properties
ms.openlocfilehash: 347cedbf5fdebc985d75c6cad3c28f17d1344993
ms.sourcegitcommit: f3512e3a98e685a3ba409c1d0157ce85cc390cf4
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/10/2020
ms.locfileid: "94429629"
---
# <a name="generated-values"></a><span data-ttu-id="cec7f-103">Valores generados</span><span class="sxs-lookup"><span data-stu-id="cec7f-103">Generated Values</span></span>

## <a name="value-generation-patterns"></a><span data-ttu-id="cec7f-104">Patrones de generación de valores</span><span class="sxs-lookup"><span data-stu-id="cec7f-104">Value generation patterns</span></span>

<span data-ttu-id="cec7f-105">Hay tres patrones de generación de valores que se pueden usar para las propiedades:</span><span class="sxs-lookup"><span data-stu-id="cec7f-105">There are three value generation patterns that can be used for properties:</span></span>

* <span data-ttu-id="cec7f-106">Sin generación de valores</span><span class="sxs-lookup"><span data-stu-id="cec7f-106">No value generation</span></span>
* <span data-ttu-id="cec7f-107">Valor generado al agregar</span><span class="sxs-lookup"><span data-stu-id="cec7f-107">Value generated on add</span></span>
* <span data-ttu-id="cec7f-108">Valor generado al agregar o actualizar</span><span class="sxs-lookup"><span data-stu-id="cec7f-108">Value generated on add or update</span></span>

### <a name="no-value-generation"></a><span data-ttu-id="cec7f-109">Sin generación de valores</span><span class="sxs-lookup"><span data-stu-id="cec7f-109">No value generation</span></span>

<span data-ttu-id="cec7f-110">Ninguna generación de valores significa que siempre se proporcionará un valor válido que se va a guardar en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="cec7f-110">No value generation means that you will always supply a valid value to be saved to the database.</span></span> <span data-ttu-id="cec7f-111">Este valor válido se debe asignar a las nuevas entidades antes de que se agreguen al contexto.</span><span class="sxs-lookup"><span data-stu-id="cec7f-111">This valid value must be assigned to new entities before they are added to the context.</span></span>

### <a name="value-generated-on-add"></a><span data-ttu-id="cec7f-112">Valor generado al agregar</span><span class="sxs-lookup"><span data-stu-id="cec7f-112">Value generated on add</span></span>

<span data-ttu-id="cec7f-113">El valor generado al agregar significa que se genera un valor para las nuevas entidades.</span><span class="sxs-lookup"><span data-stu-id="cec7f-113">Value generated on add means that a value is generated for new entities.</span></span>

<span data-ttu-id="cec7f-114">Dependiendo del proveedor de base de datos que se use, es posible que se generen valores de cliente en EF o en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="cec7f-114">Depending on the database provider being used, values may be generated client side by EF or in the database.</span></span> <span data-ttu-id="cec7f-115">Si la base de datos genera el valor, EF puede asignar un valor temporal al agregar la entidad al contexto.</span><span class="sxs-lookup"><span data-stu-id="cec7f-115">If the value is generated by the database, then EF may assign a temporary value when you add the entity to the context.</span></span> <span data-ttu-id="cec7f-116">Este valor temporal se reemplazará por el valor generado por la base de datos durante `SaveChanges()` .</span><span class="sxs-lookup"><span data-stu-id="cec7f-116">This temporary value will then be replaced by the database generated value during `SaveChanges()`.</span></span>

<span data-ttu-id="cec7f-117">Si agrega una entidad al contexto que tiene un valor asignado a la propiedad, EF intentará insertar ese valor en lugar de generar uno nuevo.</span><span class="sxs-lookup"><span data-stu-id="cec7f-117">If you add an entity to the context that has a value assigned to the property, then EF will attempt to insert that value rather than generating a new one.</span></span> <span data-ttu-id="cec7f-118">Se considera que una propiedad tiene un valor asignado si no se le asigna el valor predeterminado de CLR ( `null` para, `string` para, `0` `int` `Guid.Empty` `Guid` etc.).</span><span class="sxs-lookup"><span data-stu-id="cec7f-118">A property is considered to have a value assigned if it is not assigned the CLR default value (`null` for `string`, `0` for `int`, `Guid.Empty` for `Guid`, etc.).</span></span> <span data-ttu-id="cec7f-119">Para obtener más información, vea [valores explícitos para las propiedades generadas](xref:core/saving/explicit-values-generated-properties).</span><span class="sxs-lookup"><span data-stu-id="cec7f-119">For more information, see [Explicit values for generated properties](xref:core/saving/explicit-values-generated-properties).</span></span>

> [!WARNING]
> <span data-ttu-id="cec7f-120">La forma en que se genera el valor para las entidades agregadas dependerá del proveedor de base de datos que se use.</span><span class="sxs-lookup"><span data-stu-id="cec7f-120">How the value is generated for added entities will depend on the database provider being used.</span></span> <span data-ttu-id="cec7f-121">Los proveedores de bases de datos pueden configurar automáticamente la generación de valores para algunos tipos de propiedad, pero otros pueden requerir que se configure manualmente cómo se genera el valor.</span><span class="sxs-lookup"><span data-stu-id="cec7f-121">Database providers may automatically set up value generation for some property types, but others may require you to manually set up how the value is generated.</span></span>
>
> <span data-ttu-id="cec7f-122">Por ejemplo, al usar SQL Server, los valores se generarán automáticamente para `GUID` las propiedades (mediante el algoritmo GUID secuencial SQL Server).</span><span class="sxs-lookup"><span data-stu-id="cec7f-122">For example, when using SQL Server, values will be automatically generated for `GUID` properties (using the SQL Server sequential GUID algorithm).</span></span> <span data-ttu-id="cec7f-123">Sin embargo, si especifica que `DateTime` se genere una propiedad en Add, debe configurar una manera de que se generen los valores.</span><span class="sxs-lookup"><span data-stu-id="cec7f-123">However, if you specify that a `DateTime` property is generated on add, then you must set up a way for the values to be generated.</span></span> <span data-ttu-id="cec7f-124">Una manera de hacerlo es configurar un valor predeterminado de `GETDATE()` , vea [valores predeterminados](#default-values).</span><span class="sxs-lookup"><span data-stu-id="cec7f-124">One way to do this, is to configure a default value of `GETDATE()`, see [Default Values](#default-values).</span></span>

### <a name="value-generated-on-add-or-update"></a><span data-ttu-id="cec7f-125">Valor generado al agregar o actualizar</span><span class="sxs-lookup"><span data-stu-id="cec7f-125">Value generated on add or update</span></span>

<span data-ttu-id="cec7f-126">El valor generado al agregar o actualizar significa que se genera un nuevo valor cada vez que se guarda el registro (Insert o Update).</span><span class="sxs-lookup"><span data-stu-id="cec7f-126">Value generated on add or update means that a new value is generated every time the record is saved (insert or update).</span></span>

<span data-ttu-id="cec7f-127">Al igual que `value generated on add` , si especifica un valor para la propiedad en una instancia recién agregada de una entidad, se insertará ese valor en lugar de un valor que se va a generar.</span><span class="sxs-lookup"><span data-stu-id="cec7f-127">Like `value generated on add`, if you specify a value for the property on a newly added instance of an entity, that value will be inserted rather than a value being generated.</span></span> <span data-ttu-id="cec7f-128">También es posible establecer un valor explícito al actualizar.</span><span class="sxs-lookup"><span data-stu-id="cec7f-128">It is also possible to set an explicit value when updating.</span></span> <span data-ttu-id="cec7f-129">Para obtener más información, vea [valores explícitos para las propiedades generadas](xref:core/saving/explicit-values-generated-properties).</span><span class="sxs-lookup"><span data-stu-id="cec7f-129">For more information, see [Explicit values for generated properties](xref:core/saving/explicit-values-generated-properties).</span></span>

> [!WARNING]
> <span data-ttu-id="cec7f-130">La forma en que se genera el valor para las entidades agregadas y actualizadas dependerá del proveedor de base de datos que se use.</span><span class="sxs-lookup"><span data-stu-id="cec7f-130">How the value is generated for added and updated entities will depend on the database provider being used.</span></span> <span data-ttu-id="cec7f-131">Los proveedores de bases de datos pueden configurar automáticamente la generación de valores para algunos tipos de propiedades, mientras que otros requerirán que se configure manualmente cómo se genera el valor.</span><span class="sxs-lookup"><span data-stu-id="cec7f-131">Database providers may automatically set up value generation for some property types, while others will require you to manually set up how the value is generated.</span></span>
>
> <span data-ttu-id="cec7f-132">Por ejemplo, al usar SQL Server, `byte[]` las propiedades que se establecen tal y como se generan al agregar o actualizar y marcadas como tokens de simultaneidad, se configurarán con el `rowversion` tipo de datos, de modo que los valores se generarán en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="cec7f-132">For example, when using SQL Server, `byte[]` properties that are set as generated on add or update and marked as concurrency tokens, will be set up with the `rowversion` data type - so that values will be generated in the database.</span></span> <span data-ttu-id="cec7f-133">Sin embargo, si especifica que `DateTime` se genere una propiedad al agregar o actualizar, debe configurar una manera de que se generen los valores.</span><span class="sxs-lookup"><span data-stu-id="cec7f-133">However, if you specify that a `DateTime` property is generated on add or update, then you must set up a way for the values to be generated.</span></span> <span data-ttu-id="cec7f-134">Una forma de hacerlo consiste en configurar un valor predeterminado de `GETDATE()` (vea [valores predeterminados](#default-values)) para generar valores para las nuevas filas.</span><span class="sxs-lookup"><span data-stu-id="cec7f-134">One way to do this, is to configure a default value of `GETDATE()` (see [Default Values](#default-values)) to generate values for new rows.</span></span> <span data-ttu-id="cec7f-135">Después, puede usar un desencadenador de base de datos para generar valores durante las actualizaciones (como el siguiente desencadenador de ejemplo).</span><span class="sxs-lookup"><span data-stu-id="cec7f-135">You could then use a database trigger to generate values during updates (such as the following example trigger).</span></span>
>
> [!code-sql[Main](../../../samples/core/Modeling/FluentAPI/ValueGeneratedOnAddOrUpdate.sql)]

## <a name="value-generated-on-add"></a><span data-ttu-id="cec7f-136">Valor generado al agregar</span><span class="sxs-lookup"><span data-stu-id="cec7f-136">Value generated on add</span></span>

<span data-ttu-id="cec7f-137">Por Convención, las claves principales no compuestas de tipo Short, int, Long o GUID están configuradas para que tengan valores generados para las entidades insertadas, si la aplicación no proporciona un valor.</span><span class="sxs-lookup"><span data-stu-id="cec7f-137">By convention, non-composite primary keys of type short, int, long, or Guid are set up to have values generated for inserted entities, if a value isn't provided by the application.</span></span> <span data-ttu-id="cec7f-138">Normalmente, el proveedor de base de datos se encarga de la configuración necesaria. por ejemplo, una clave principal numérica en SQL Server se configura automáticamente para que sea una columna de identidad.</span><span class="sxs-lookup"><span data-stu-id="cec7f-138">Your database provider typically takes care of the necessary configuration; for example, a numeric primary key in SQL Server is automatically set up to be an IDENTITY column.</span></span>

<span data-ttu-id="cec7f-139">Puede configurar cualquier propiedad para que se genere su valor para las entidades insertadas como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="cec7f-139">You can configure any property to have its value generated for inserted entities as follows:</span></span>

### <a name="data-annotations"></a>[<span data-ttu-id="cec7f-140">Anotaciones de datos</span><span class="sxs-lookup"><span data-stu-id="cec7f-140">Data Annotations</span></span>](#tab/data-annotations)

[!code-csharp[Main](../../../samples/core/Modeling/DataAnnotations/ValueGeneratedOnAdd.cs?name=ValueGeneratedOnAdd&highlight=5)]

### <a name="fluent-api"></a>[<span data-ttu-id="cec7f-141">API fluida</span><span class="sxs-lookup"><span data-stu-id="cec7f-141">Fluent API</span></span>](#tab/fluent-api)

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/ValueGeneratedOnAdd.cs?name=ValueGeneratedOnAdd&highlight=5)]

***

> [!WARNING]
> <span data-ttu-id="cec7f-142">Esto solo permite que EF sepa que los valores se generan para las entidades agregadas, no garantiza que EF configurará el mecanismo real para generar valores.</span><span class="sxs-lookup"><span data-stu-id="cec7f-142">This just lets EF know that values are generated for added entities, it does not guarantee that EF will set up the actual mechanism to generate values.</span></span> <span data-ttu-id="cec7f-143">Vea la sección [valor generado al agregar](#value-generated-on-add) para obtener más detalles.</span><span class="sxs-lookup"><span data-stu-id="cec7f-143">See [Value generated on add](#value-generated-on-add) section for more details.</span></span>

### <a name="default-values"></a><span data-ttu-id="cec7f-144">Valores predeterminados</span><span class="sxs-lookup"><span data-stu-id="cec7f-144">Default values</span></span>

<span data-ttu-id="cec7f-145">En las bases de datos relacionales, una columna se puede configurar con un valor predeterminado. Si se inserta una fila sin un valor para esa columna, se usará el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="cec7f-145">On relational databases, a column can be configured with a default value; if a row is inserted without a value for that column, the default value will be used.</span></span>

<span data-ttu-id="cec7f-146">Puede configurar un valor predeterminado en una propiedad:</span><span class="sxs-lookup"><span data-stu-id="cec7f-146">You can configure a default value on a property:</span></span>

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/DefaultValue.cs?name=DefaultValue&highlight=5)]

<span data-ttu-id="cec7f-147">También puede especificar un fragmento de SQL que se usa para calcular el valor predeterminado:</span><span class="sxs-lookup"><span data-stu-id="cec7f-147">You can also specify a SQL fragment that is used to calculate the default value:</span></span>

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/DefaultValueSql.cs?name=DefaultValueSql&highlight=5)]

<span data-ttu-id="cec7f-148">Si se especifica un valor predeterminado, se configurará implícitamente la propiedad como valor generado al agregar.</span><span class="sxs-lookup"><span data-stu-id="cec7f-148">Specifying a default value will implicitly configure the property as value generated on add.</span></span>

## <a name="value-generated-on-add-or-update"></a><span data-ttu-id="cec7f-149">Valor generado al agregar o actualizar</span><span class="sxs-lookup"><span data-stu-id="cec7f-149">Value generated on add or update</span></span>

### <a name="data-annotations"></a>[<span data-ttu-id="cec7f-150">Anotaciones de datos</span><span class="sxs-lookup"><span data-stu-id="cec7f-150">Data Annotations</span></span>](#tab/data-annotations)

[!code-csharp[Main](../../../samples/core/Modeling/DataAnnotations/ValueGeneratedOnAddOrUpdate.cs?name=ValueGeneratedOnAddOrUpdate&highlight=5)]

### <a name="fluent-api"></a>[<span data-ttu-id="cec7f-151">API fluida</span><span class="sxs-lookup"><span data-stu-id="cec7f-151">Fluent API</span></span>](#tab/fluent-api)

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/ValueGeneratedOnAddOrUpdate.cs?name=ValueGeneratedOnAddOrUpdate&highlight=5)]

<span data-ttu-id="cec7f-152">\*\*_</span><span class="sxs-lookup"><span data-stu-id="cec7f-152">\*\*_</span></span>

> [!WARNING]
> <span data-ttu-id="cec7f-153">Esto solo permite que EF sepa que se generan valores para entidades agregadas o actualizadas, no garantiza que EF configurará el mecanismo real para generar valores.</span><span class="sxs-lookup"><span data-stu-id="cec7f-153">This just lets EF know that values are generated for added or updated entities, it does not guarantee that EF will set up the actual mechanism to generate values.</span></span> <span data-ttu-id="cec7f-154">Vea la sección [valor generado al agregar o actualizar](#value-generated-on-add-or-update) para obtener más detalles.</span><span class="sxs-lookup"><span data-stu-id="cec7f-154">See [Value generated on add or update](#value-generated-on-add-or-update) section for more details.</span></span>

### <a name="computed-columns"></a><span data-ttu-id="cec7f-155">Columnas calculadas</span><span class="sxs-lookup"><span data-stu-id="cec7f-155">Computed columns</span></span>

<span data-ttu-id="cec7f-156">En la mayoría de las bases de datos relacionales, una columna se puede configurar para que se calcule su valor en la base de datos, normalmente con una expresión que haga referencia a otras columnas:</span><span class="sxs-lookup"><span data-stu-id="cec7f-156">On most relational databases, a column can be configured to have its value computed in the database, typically with an expression referring to other columns:</span></span>

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/ComputedColumn.cs?name=DefaultComputedColumn)]

<span data-ttu-id="cec7f-157">Lo anterior crea una columna calculada de _virtual \*, cuyo valor se calcula cada vez que se captura de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="cec7f-157">The above creates a _virtual\* computed column, whose value is computed every time it is fetched from the database.</span></span> <span data-ttu-id="cec7f-158">También puede especificar que una columna calculada se *almacene* (a veces denominada *Persist* ), lo que significa que se calcula en cada actualización de la fila y se almacena en el disco junto con las columnas normales:</span><span class="sxs-lookup"><span data-stu-id="cec7f-158">You may also specify that a computed column be *stored* (sometimes called *persisted* ), meaning that it is computed on every update of the row, and is stored on disk alongside regular columns:</span></span>

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/ComputedColumn.cs?name=StoredComputedColumn)]

> [!NOTE]
> <span data-ttu-id="cec7f-159">La compatibilidad con la creación de columnas calculadas almacenadas se agregó en EF Core 5,0.</span><span class="sxs-lookup"><span data-stu-id="cec7f-159">Support for creating stored computed columns was added in EF Core 5.0.</span></span>

## <a name="no-value-generation"></a><span data-ttu-id="cec7f-160">Sin generación de valores</span><span class="sxs-lookup"><span data-stu-id="cec7f-160">No value generation</span></span>

<span data-ttu-id="cec7f-161">Normalmente, es necesario deshabilitar la generación de valores en una propiedad si una Convención la configura para la generación de valores.</span><span class="sxs-lookup"><span data-stu-id="cec7f-161">Disabling value generation on a property is typically necessary if a convention configures it for value generation.</span></span> <span data-ttu-id="cec7f-162">Por ejemplo, si tiene una clave principal de tipo int, se establecerá implícitamente configurada como valor generado al agregar; puede deshabilitarlo a través de lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="cec7f-162">For example, if you have a primary key of type int, it will be implicitly set configured as value generated on add; you can disable this via the following:</span></span>

### <a name="data-annotations"></a>[<span data-ttu-id="cec7f-163">Anotaciones de datos</span><span class="sxs-lookup"><span data-stu-id="cec7f-163">Data Annotations</span></span>](#tab/data-annotations)

[!code-csharp[Main](../../../samples/core/Modeling/DataAnnotations/ValueGeneratedNever.cs?name=ValueGeneratedNever&highlight=3)]

### <a name="fluent-api"></a>[<span data-ttu-id="cec7f-164">API fluida</span><span class="sxs-lookup"><span data-stu-id="cec7f-164">Fluent API</span></span>](#tab/fluent-api)

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/ValueGeneratedNever.cs?name=ValueGeneratedNever&highlight=5)]

***
